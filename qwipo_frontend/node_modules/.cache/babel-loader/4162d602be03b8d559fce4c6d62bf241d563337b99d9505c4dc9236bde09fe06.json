{"ast":null,"code":"var _jsxFileName = \"D:\\\\Qwipo\\\\qwipo_frontend\\\\src\\\\pages\\\\CustomerFormPage.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport CustomerForm from '../components/CustomerForm';\nimport { api, handleError } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function CustomerFormPage({\n  mode\n}) {\n  _s();\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const [initial, setInitial] = useState({});\n  const [error, setError] = useState('');\n  useEffect(() => {\n    if (mode === 'edit' && id) {\n      api.get(`/customers/${id}`).then(r => {\n        const c = r.data.data;\n        setInitial({\n          first_name: c.first_name,\n          last_name: c.last_name,\n          phone_number: c.phone_number,\n          addresses: c.addresses\n        });\n      }).catch(e => setError(handleError(e)));\n    }\n  }, [mode, id]);\n  const onSubmit = async payload => {\n    try {\n      if (mode === 'create') {\n        await api.post('/customers', payload);\n      } else {\n        await api.put(`/customers/${id}`, {\n          first_name: payload.first_name,\n          last_name: payload.last_name,\n          phone_number: payload.phone_number\n        });\n        // Sync addresses: naive way — delete all then re-add\n        const detail = await api.get(`/customers/${id}`);\n        const current = detail.data.data.addresses;\n        for (const a of current) await api.delete(`/addresses/${a.id}`);\n        for (const a of payload.addresses) await api.post(`/customers/${id}/addresses`, a);\n      }\n      navigate('/customers');\n    } catch (e) {\n      throw new Error(handleError(e));\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      style: {\n        marginBottom: 8\n      },\n      children: mode === 'create' ? 'Create New Customer' : `Edit Customer #${id}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(CustomerForm, {\n      initial: initial,\n      onSubmit: onSubmit,\n      mode: mode\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 5\n  }, this);\n}\n_s(CustomerFormPage, \"gSouYFUIoBLA11OCmUiLWYZqQWk=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = CustomerFormPage;\nvar _c;\n$RefreshReg$(_c, \"CustomerFormPage\");","map":{"version":3,"names":["React","useEffect","useState","useNavigate","useParams","CustomerForm","api","handleError","jsxDEV","_jsxDEV","CustomerFormPage","mode","_s","id","navigate","initial","setInitial","error","setError","get","then","r","c","data","first_name","last_name","phone_number","addresses","catch","e","onSubmit","payload","post","put","detail","current","a","delete","Error","children","style","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","className","_c","$RefreshReg$"],"sources":["D:/Qwipo/qwipo_frontend/src/pages/CustomerFormPage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport CustomerForm from '../components/CustomerForm';\nimport { api, handleError } from '../services/api';\n\nexport default function CustomerFormPage({ mode }){\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [initial, setInitial] = useState({});\n  const [error, setError] = useState('');\n\n  useEffect(()=>{\n    if (mode==='edit' && id) {\n      api.get(`/customers/${id}`).then(r=>{\n        const c = r.data.data;\n        setInitial({ first_name:c.first_name, last_name:c.last_name, phone_number:c.phone_number, addresses: c.addresses });\n      }).catch(e=>setError(handleError(e)));\n    }\n  },[mode,id]);\n\n  const onSubmit = async (payload) => {\n    try {\n      if (mode==='create') {\n        await api.post('/customers', payload);\n      } else {\n        await api.put(`/customers/${id}`, { first_name: payload.first_name, last_name: payload.last_name, phone_number: payload.phone_number });\n        // Sync addresses: naive way — delete all then re-add\n        const detail = await api.get(`/customers/${id}`);\n        const current = detail.data.data.addresses;\n        for (const a of current) await api.delete(`/addresses/${a.id}`);\n        for (const a of payload.addresses) await api.post(`/customers/${id}/addresses`, a);\n      }\n      navigate('/customers');\n    } catch (e) {\n      throw new Error(handleError(e));\n    }\n  };\n\n  return (\n    <div>\n      <h2 style={{marginBottom:8}}>{mode==='create' ? 'Create New Customer' : `Edit Customer #${id}`}</h2>\n      {error && <div className=\"alert error\">{error}</div>}\n      <CustomerForm initial={initial} onSubmit={onSubmit} mode={mode} />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}